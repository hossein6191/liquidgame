<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
<title>Liquid Runner</title>
<link rel="icon" type="image/png" href="https://raw.githubusercontent.com/hossein6191/liquid/main/Favicon1-4K.png">
<style>
@import url('https://fonts.googleapis.com/css2?family=Space+Grotesk:wght@400;600;700&family=JetBrains+Mono:wght@400;700;800&family=Inter:wght@400;600;800;900&display=swap');
*{margin:0;padding:0;box-sizing:border-box}
body{background:#0d1228;font-family:'Inter',sans-serif;color:#e8eaf0;overflow:hidden;height:100dvh;width:100vw;user-select:none;-webkit-tap-highlight-color:transparent}
canvas{display:block;position:fixed;top:0;left:0;z-index:1}

@keyframes fadeUp{from{opacity:0;transform:translateY(16px)}to{opacity:1;transform:translateY(0)}}
@keyframes glowPulse{0%,100%{text-shadow:0 0 30px rgba(92,225,230,.3),0 0 60px rgba(56,182,255,.1)}50%{text-shadow:0 0 50px rgba(92,225,230,.6),0 0 80px rgba(56,182,255,.2)}}
@keyframes shimmer{0%{background-position:-200% 0}100%{background-position:200% 0}}
@keyframes breathe{0%,100%{transform:scale(1)}50%{transform:scale(1.02)}}
@keyframes float{0%,100%{transform:translateY(0)}50%{transform:translateY(-10px)}}
@keyframes wobble{0%{transform:scale(1)}25%{transform:scale(1.15) rotate(-3deg)}50%{transform:scale(.88) rotate(2deg)}75%{transform:scale(1.08) rotate(-1deg)}100%{transform:scale(1)}}
@keyframes burstIn{0%{transform:translate(-50%,-50%) scale(0);opacity:0}60%{transform:translate(-50%,-50%) scale(1.15);opacity:1}100%{transform:translate(-50%,-50%) scale(1);opacity:1}}
@keyframes rippleOut{0%{transform:scale(1);opacity:.35}100%{transform:scale(2.5);opacity:0}}

/* SCREENS */
.scr{position:fixed;inset:0;z-index:100;display:flex;flex-direction:column;align-items:center;justify-content:center;background:linear-gradient(170deg,#0f1730 0%,#111d3a 30%,#142244 55%,#0f1730 100%);transition:opacity .4s;overflow-y:auto;padding:20px 16px 60px;-webkit-overflow-scrolling:touch}
.scr.off{opacity:0;pointer-events:none}
.scr.sc-top{justify-content:flex-start}

/* BUBBLE SCREEN */
.bubble-wrap{display:flex;flex-direction:column;align-items:center;gap:14px;z-index:10}
.bubble-hint{font-family:'JetBrains Mono',monospace;font-size:12px;color:rgba(92,225,230,.6);letter-spacing:4px;text-transform:uppercase}
.bubble{width:clamp(130px,35vw,180px);height:clamp(160px,42vw,220px);cursor:pointer;transition:transform .15s;filter:drop-shadow(0 0 50px rgba(92,225,230,.3)) drop-shadow(0 0 100px rgba(56,182,255,.15));animation:float 3s ease-in-out infinite}
.bubble:active{transform:scale(.88)}
.bubble.wobble{animation:wobble .35s ease}
.bubble-count{font-family:'JetBrains Mono',monospace;font-size:26px;font-weight:800;color:rgba(92,225,230,.15);height:34px}
.bubble-burst{position:fixed;top:50%;left:50%;transform:translate(-50%,-50%);font-size:clamp(18px,5vw,28px);font-weight:900;letter-spacing:4px;background:linear-gradient(135deg,#5ce1e6,#38b6ff,#a78bfa);-webkit-background-clip:text;-webkit-text-fill-color:transparent;display:none;z-index:200;pointer-events:none}
.burst-particles{position:fixed;inset:0;pointer-events:none;z-index:190}

/* FLYING DROP ICONS ‚Äî small, from top/bottom */
@keyframes iconDown{0%{transform:translateY(-80px);opacity:0}100%{transform:translateY(0);opacity:1}}
@keyframes iconUp{0%{transform:translateY(80px);opacity:0}100%{transform:translateY(0);opacity:1}}
@keyframes iconBob{0%,100%{transform:translateY(0)}50%{transform:translateY(6px)}}

.fly-icon{display:flex;flex-direction:column;align-items:center;gap:4px;margin:10px 0;cursor:pointer;opacity:0;transition:transform .3s,opacity .3s}
.fly-icon img{width:50px;height:auto;filter:drop-shadow(0 0 15px rgba(92,225,230,.15));transition:transform .15s}
.fly-icon:hover img{transform:scale(1.1)}
.fly-icon:active img{transform:scale(.8)}
.fly-icon span{font-family:'JetBrains Mono',monospace;font-size:8px;color:rgba(92,225,230,.25);letter-spacing:2px;text-transform:uppercase}
.fly-icon.anim{animation:iconDown 2.5s ease-out both,iconBob 3.5s ease-in-out 3s infinite}
.fly-icon.fly-bot.anim{animation:iconUp 2.5s ease-out .4s both,iconBob 3.5s ease-in-out 3.4s infinite}
.fly-icon.pop{animation:none !important;transform:scale(0) !important;opacity:0 !important;transition:all .4s}

/* GLIQUID POPUP ‚Äî small */
.gliq{position:fixed;top:50%;left:50%;transform:translate(-50%,-50%) scale(0);font-family:'Inter',sans-serif;font-size:clamp(16px,4vw,24px);font-weight:900;letter-spacing:4px;background:linear-gradient(135deg,#5ce1e6,#38b6ff,#a78bfa);-webkit-background-clip:text;-webkit-text-fill-color:transparent;z-index:350;pointer-events:none;opacity:0;transition:all .35s cubic-bezier(.34,1.56,.64,1)}
.gliq.show{transform:translate(-50%,-50%) scale(1);opacity:1}

/* LOGO */
.logo-img{width:clamp(150px,42vw,250px);margin:8px 0;animation:breathe 4s ease-in-out infinite}
.tag{font-family:'JetBrains Mono',monospace;font-size:10px;color:rgba(92,225,230,.5);letter-spacing:7px;margin-bottom:18px;text-transform:uppercase;animation:glowPulse 4s infinite}

/* BOXES */
.bx{background:linear-gradient(135deg,rgba(92,225,230,.06),rgba(56,182,255,.03));border:1px solid rgba(92,225,230,.12);border-radius:18px;padding:15px 18px;max-width:420px;width:92%;margin-bottom:9px;text-align:left;animation:fadeUp .5s ease both;backdrop-filter:blur(8px)}
.bx h3{font-family:'Space Grotesk',sans-serif;font-size:14px;font-weight:700;color:#5ce1e6;margin-bottom:6px;display:flex;align-items:center;gap:5px}
.bx p{font-family:'JetBrains Mono',monospace;font-size:10.5px;line-height:1.85;color:rgba(255,255,255,.5)}
.bx p b{color:rgba(255,255,255,.8)}
.bx .w{margin-top:6px;padding-top:6px;border-top:1px solid rgba(255,255,255,.03);color:rgba(255,180,0,.2);font-size:8.5px}

/* COINS */
.coins{display:grid;grid-template-columns:repeat(5,1fr);gap:7px;max-width:420px;width:92%;margin:0 auto 12px}
@media(max-width:520px){.coins{grid-template-columns:repeat(3,1fr)}}
.cc{background:rgba(92,225,230,.015);border:2px solid rgba(92,225,230,.04);border-radius:14px;padding:10px 4px;text-align:center;cursor:pointer;transition:all .2s}
.cc:hover{background:rgba(92,225,230,.04);border-color:rgba(92,225,230,.15);transform:translateY(-2px)}
.cc.sel{background:rgba(92,225,230,.08);border-color:#5ce1e6;box-shadow:0 0 30px rgba(92,225,230,.1),inset 0 0 20px rgba(92,225,230,.03)}
.cc .sy{font-family:'Space Grotesk',sans-serif;font-size:14px;font-weight:700}
.cc .pr{font-family:'JetBrains Mono',monospace;font-size:8px;color:rgba(255,255,255,.2);margin-top:3px}
.cc .ch{font-family:'JetBrains Mono',monospace;font-size:8px;margin-top:1px}
.cc .df{font-family:'JetBrains Mono',monospace;font-size:7px;margin-top:3px;padding:2px 6px;border-radius:10px;display:inline-block}
.up{color:#34d399}.dn{color:#f87171}

/* BUTTONS */
.btn{font-family:'Space Grotesk',sans-serif;font-size:15px;font-weight:700;padding:14px 42px;border:none;border-radius:50px;cursor:pointer;transition:all .2s;letter-spacing:.5px;position:relative;overflow:hidden;display:inline-block;text-align:center}
.btn-go{background:linear-gradient(135deg,#5ce1e6,#38b6ff);color:#0a0e1a;box-shadow:0 0 30px rgba(92,225,230,.15),0 0 60px rgba(56,182,255,.08)}
.btn-go::before{content:'';position:absolute;inset:-5px;border-radius:55px;background:rgba(92,225,230,.06);animation:breathe 2.5s ease-in-out infinite;z-index:-1}
.btn-go::after{content:'';position:absolute;inset:0;background:linear-gradient(90deg,transparent,rgba(255,255,255,.1),transparent);background-size:200% 100%;animation:shimmer 3s infinite}
.btn-go:hover{transform:scale(1.04);box-shadow:0 0 40px rgba(92,225,230,.25),0 0 80px rgba(56,182,255,.12)}
.btn-go:disabled{opacity:.15;cursor:default;transform:none;box-shadow:none}
.btn-go:disabled::before,.btn-go:disabled::after{display:none}
.ripple-fx{position:absolute;border-radius:50%;background:rgba(92,225,230,.3);pointer-events:none;animation:rippleOut .6s ease-out forwards}
.btn-bk{background:rgba(92,225,230,.03);color:rgba(92,225,230,.35);border:1px solid rgba(92,225,230,.06);font-size:11px;padding:8px 20px;margin-top:6px}
.btn-lb{background:rgba(255,214,0,.04);color:rgba(255,214,0,.45);border:1px solid rgba(255,214,0,.08);font-size:11px;padding:8px 18px;margin-top:4px}

.ft{font-family:'JetBrains Mono',monospace;font-size:9px;color:rgba(92,225,230,.2);margin-top:14px;letter-spacing:1px;text-align:center;line-height:1.8}
.ft a{color:rgba(92,225,230,.4);text-decoration:none}

/* HUD */
.hud{position:fixed;top:0;left:0;right:0;padding:10px 14px;display:none;justify-content:space-between;align-items:flex-start;pointer-events:none;z-index:50}
.hc{display:flex;flex-direction:column}
.hl{font-family:'JetBrains Mono',monospace;font-size:7px;letter-spacing:2px;text-transform:uppercase;color:rgba(92,225,230,.2)}
.hv{font-family:'Space Grotesk',sans-serif;font-size:16px;font-weight:700;color:#5ce1e6}
.hv.gd{color:#fbbf24}
.hp{font-family:'JetBrains Mono',monospace;font-size:10px;font-weight:700;color:rgba(255,255,255,.22);text-align:center}
.db{font-family:'JetBrains Mono',monospace;font-size:7px;letter-spacing:1.5px;padding:2px 8px;border-radius:20px;margin-top:2px;display:inline-block}

.sbar{position:fixed;top:0;left:0;right:0;height:3px;z-index:55;pointer-events:none;opacity:0;transition:opacity .15s}
.sbar.on{opacity:1}
.sbar .fl{height:100%;background:linear-gradient(90deg,#fbbf24,#f97316);border-radius:0 2px 2px 0;transition:width .06s linear}

.tip{position:fixed;bottom:50px;left:50%;transform:translateX(-50%) translateY(12px);background:rgba(10,14,26,.92);border:1px solid rgba(92,225,230,.1);backdrop-filter:blur(20px);border-radius:16px;padding:11px 16px;max-width:320px;width:84%;text-align:center;font-family:'JetBrains Mono',monospace;font-size:10.5px;line-height:1.5;color:#5ce1e6;opacity:0;transition:all .35s;pointer-events:none;z-index:60}
.tip.on{opacity:1;transform:translateX(-50%) translateY(0)}
.tip .tt{font-family:'Space Grotesk',sans-serif;font-weight:700;font-size:12px;color:#fbbf24;margin-bottom:2px}

.cd-o{position:fixed;top:50%;left:50%;transform:translate(-50%,-50%);font-family:'Space Grotesk',sans-serif;font-size:72px;font-weight:700;color:rgba(92,225,230,.25);z-index:80;pointer-events:none;opacity:0;transition:opacity .12s}
.cd-o.on{opacity:1}

.gos{display:flex;gap:18px;margin:12px 0 14px;flex-wrap:wrap;justify-content:center}
.gos>div{text-align:center;min-width:50px}
.gos .n{font-family:'Space Grotesk',sans-serif;font-size:24px;font-weight:700;color:#5ce1e6}
.gos .l{font-family:'JetBrains Mono',monospace;font-size:7px;letter-spacing:2px;color:rgba(92,225,230,.18);text-transform:uppercase;margin-top:2px}

.ni{font-family:'JetBrains Mono',monospace;font-size:14px;background:rgba(92,225,230,.02);border:1.5px solid rgba(92,225,230,.1);border-radius:14px;padding:11px 16px;color:#e8eaf0;text-align:center;width:200px;outline:none;margin:5px 0 10px}
.ni:focus{border-color:#5ce1e6;box-shadow:0 0 30px rgba(92,225,230,.08)}

.lb{max-width:360px;width:92%;margin:8px auto}
.lb h4{font-family:'Space Grotesk',sans-serif;font-size:12px;color:#fbbf24;margin-bottom:8px;text-align:center}
.lr{display:flex;justify-content:space-between;font-family:'JetBrains Mono',monospace;font-size:9.5px;padding:4px 0;border-bottom:1px solid rgba(92,225,230,.03)}
.lr .rk{color:rgba(255,255,255,.18);width:28px}
.lr .nm{color:rgba(255,255,255,.35);flex:1}
.lr .sv{color:rgba(92,225,230,.6);text-align:right;font-size:8.5px}
.lr.me{background:rgba(255,214,0,.03);border-radius:6px;padding:4px 6px}
.lr.me .nm,.lr.me .sv{color:#fbbf24}

.lbPanel{display:none;animation:fadeUp .3s ease}
.lbPanel.show{display:block}

.mt{position:fixed;bottom:12px;right:12px;z-index:90;font-size:10px;background:rgba(92,225,230,.03);border:1px solid rgba(92,225,230,.05);color:rgba(92,225,230,.25);padding:5px 10px;border-radius:20px;cursor:pointer}
</style>
</head>
<body>
<canvas id="c"></canvas>
<div class="sbar" id="sbar"><div class="fl" id="sfill"></div></div>
<button class="mt" id="mb" onclick="tgM(event)">üîä</button>

<div class="hud" id="hud">
  <div class="hc"><div class="hl">Volume</div><div class="hv" id="hS">$0</div><div class="hl" style="margin-top:4px">Time</div><div class="hv" id="hTm" style="font-size:12px">0s</div></div>
  <div class="hc" style="align-items:center"><div class="hp" id="hP">‚Äî</div><div class="db" id="hD">CHILL</div></div>
  <div class="hc" style="align-items:flex-end"><div class="hl">Drops</div><div class="hv gd" id="hT">0</div><div class="hl" style="margin-top:4px">Multiplier</div><div class="hv" id="hSu" style="font-size:12px;color:#f97316">1.0x</div></div>
</div>
<div class="tip" id="tip"><div class="tt" id="tT"></div><div id="tC"></div></div>
<div class="cd-o" id="cdEl"></div>

<!-- BUBBLE -->
<div class="scr" id="sBubble">
  <div class="bubble-wrap">
    <div class="bubble-hint" id="bHint">TAP THE BUBBLE</div>
    <div class="bubble" id="bubbleEl">
      <svg viewBox="0 0 120 150" width="100%" height="100%"><defs><radialGradient id="bg1" cx="35%" cy="30%"><stop offset="0%" stop-color="rgba(92,225,230,.7)"/><stop offset="50%" stop-color="rgba(56,182,255,.4)"/><stop offset="100%" stop-color="rgba(167,139,250,.2)"/></radialGradient><radialGradient id="sh" cx="38%" cy="28%"><stop offset="0%" stop-color="rgba(255,255,255,.55)"/><stop offset="100%" stop-color="rgba(255,255,255,0)"/></radialGradient></defs><path d="M60 10 C60 10 98 50 98 85 C98 105 81 125 60 125 C39 125 22 105 22 85 C22 50 60 10 60 10Z" fill="url(#bg1)" stroke="rgba(92,225,230,.4)" stroke-width="1.5"/><ellipse cx="46" cy="58" rx="14" ry="9" fill="url(#sh)" transform="rotate(-18 46 58)"/></svg>
    </div>
    <div class="bubble-count" id="bCount"></div>
    <div class="bubble-burst" id="bBurst">Gliquid</div>
  </div>
  <canvas class="burst-particles" id="burstC"></canvas>
</div>

<!-- INTRO -->
<div class="scr sc-top off" id="sI">
  <div class="fly-icon" id="lgT">
    <img src="https://raw.githubusercontent.com/hossein6191/liquid/main/Icon-Offwhite-4K.png" alt="" draggable="false" onerror="this.parentElement.style.display='none'">
    <span>tap me</span>
  </div>
  <img class="logo-img" src="https://raw.githubusercontent.com/hossein6191/liquid/main/Full-Logo-Offwhite-4K.png" alt="Liquid" draggable="false" onerror="this.outerHTML='<div style=\'font-size:clamp(28px,6vw,44px);font-weight:900;margin:8px 0\'><span style=\'color:#5ce1e6\'>Liquid</span> Runner</div>'">
  <div class="tag">Navigate the Charts</div>
  <div class="bx"><h3>üéÆ How to Play</h3><p><b>Tap</b> (mobile) or <b>Click / Space</b> (desktop) to fly up.<br>Release = fall. Navigate through <b>candlesticks</b>.<br>Collect <b>üíß drops</b> to charge <b>‚ö° Surge</b>.</p></div>
  <div class="bx"><h3>‚ö° Drops & Multiplier</h3><p>Each <b>üíß drop</b> = <b>+0.15x score multiplier!</b><br>More drops = higher multiplier = way more $$$.<br>Every <b>5 drops</b> = <b>6 sec Surge</b> (invincibility).<br>Every <b>10 drops</b> = a <b>fact about Liquid</b>.</p></div>
  <div class="bx"><h3>üìà Difficulty</h3><p>Each coin = different speed by <b>volatility</b>.<br>üü¢ Easy &nbsp; üü° Medium &nbsp; üî¥ Hard<br>Ramps: <b>Chill ‚Üí Medium ‚Üí Hard ‚Üí Insane</b></p>
  <p class="w">‚ö† Fan-made. Not financial advice. Prices via CoinGecko.</p></div>
  <div style="display:flex;flex-direction:column;align-items:center;gap:6px;margin-top:10px">
    <button class="btn btn-go" id="bGo">CHOOSE COIN ‚Üí</button>
    <button class="btn btn-lb" id="bLB">üèÜ LEADERBOARD</button>
  </div>
  <div class="lbPanel" id="lbPI"><div class="lb" id="lbI"></div></div>
  <div class="ft">Made by <a href="https://x.com/HossseinRezaei" target="_blank">Hellish</a> ¬∑ <a href="https://app.tryliquid.xyz" target="_blank">app.tryliquid.xyz</a></div>
  <div class="fly-icon fly-bot" id="lgB">
    <img src="https://raw.githubusercontent.com/hossein6191/liquid/main/Icon-Offwhite-4K.png" alt="" draggable="false" onerror="this.parentElement.style.display='none'">
    <span>tap me</span>
  </div>
  <div class="gliq" id="gliqP">Gliquid</div>
</div>

<!-- COIN -->
<div class="scr sc-top off" id="sC">
  <div style="font-family:'Space Grotesk',sans-serif;font-size:clamp(20px,4.5vw,30px);font-weight:700;margin:10px 0 2px"><span style="color:#5ce1e6">Select</span> Coin</div>
  <div class="tag" style="font-size:9px;margin-bottom:12px">VOLATILITY = DIFFICULTY</div>
  <div id="cA"><div style="font-family:'JetBrains Mono',monospace;font-size:10px;color:rgba(255,255,255,.15)">Fetching prices‚Ä¶</div></div>
  <div style="display:flex;flex-direction:column;align-items:center;gap:6px;margin-top:8px">
    <button class="btn btn-go" id="bSt" disabled>SELECT A COIN</button>
    <button class="btn btn-bk" id="bBI">‚Üê Back</button>
  </div>
</div>

<!-- DEAD -->
<div class="scr sc-top off" id="sD">
  <div style="font-family:'Space Grotesk',sans-serif;font-size:clamp(22px,5vw,34px);font-weight:700;margin-top:10px">Liquidated üíÄ</div>
  <div class="tag" id="dR" style="font-size:9px;margin-bottom:4px;animation:none">‚Äî</div>
  <div class="gos"><div><div class="n" id="dS">0</div><div class="l">Volume</div></div><div><div class="n" id="dTm">0</div><div class="l">Time</div></div><div><div class="n" id="dT">0</div><div class="l">Drops</div></div></div>
  <div style="font-family:'JetBrains Mono',monospace;font-size:9px;color:rgba(92,225,230,.2)">Name for leaderboard:</div>
  <input class="ni" id="nI" placeholder="Your name" maxlength="14">
  <button class="btn btn-go" id="bSv" style="font-size:13px;padding:11px 28px">SAVE & PLAY AGAIN</button>
  <div class="lb" id="lbA"></div>
  <button class="btn btn-bk" id="bBC">‚Üê Change Coin</button>
  <div class="ft">Trade ‚Üí <a href="https://app.tryliquid.xyz" target="_blank">app.tryliquid.xyz</a></div>
</div>

<script>
// RIPPLE
document.addEventListener('click',function(e){var b=e.target.closest('.btn');if(!b)return;var r=document.createElement('span');r.className='ripple-fx';var rc=b.getBoundingClientRect();var sz=Math.max(rc.width,rc.height)*2;r.style.width=r.style.height=sz+'px';r.style.left=(e.clientX-rc.left-sz/2)+'px';r.style.top=(e.clientY-rc.top-sz/2)+'px';b.appendChild(r);setTimeout(function(){r.remove()},600)});

// BUBBLE
(function(){
  var clicks=0,max=6,done=false;
  var bub=document.getElementById('bubbleEl'),cnt=document.getElementById('bCount'),bst=document.getElementById('bBurst'),hint=document.getElementById('bHint');
  var bc=document.getElementById('burstC'),bx=bc.getContext('2d'),pts=[];
  function rsz(){bc.width=innerWidth;bc.height=innerHeight}rsz();window.addEventListener('resize',rsz);
  bub.addEventListener('click',function(e){
    e.stopPropagation();if(done)return;clicks++;
    bub.classList.remove('wobble');void bub.offsetWidth;bub.classList.add('wobble');
    bub.style.transform='scale('+(1-clicks*.09)+')';
    var left=max-clicks;cnt.textContent=left>0?left+' more':'';
    hint.textContent=left>1?'KEEP TAPPING!':left===1?'ONE MORE!':'';
    var r=bub.getBoundingClientRect();sp(r.left+r.width/2,r.top+r.height/2,10,'#5ce1e6');
    if(clicks>=max){done=true;bub.style.transition='all .4s';bub.style.transform='scale(0)';bub.style.opacity='0';cnt.textContent='';hint.style.opacity='0';
      var cx=innerWidth/2,cy=innerHeight/2;sp(cx,cy,40,'#5ce1e6');sp(cx,cy,30,'#fbbf24');sp(cx,cy,20,'#a78bfa');
      setTimeout(function(){bst.style.display='block'},400);
      setTimeout(function(){document.getElementById('sBubble').classList.add('off');document.getElementById('sI').classList.remove('off');
        // Trigger logo slide-in animations
        setTimeout(function(){var t=document.getElementById('lgT'),b=document.getElementById('lgB');if(t)t.classList.add('anim');if(b)b.classList.add('anim')},200);
      },2000)}
  });
  function sp(cx,cy,n,c){for(var i=0;i<n;i++){var a=Math.random()*Math.PI*2,s=2+Math.random()*7;pts.push({x:cx,y:cy,vx:Math.cos(a)*s,vy:Math.sin(a)*s-1,l:30+Math.random()*20,ml:50,s:2+Math.random()*5,c:c})}}
  (function anim(){bx.clearRect(0,0,bc.width,bc.height);for(var i=pts.length-1;i>=0;i--){var p=pts[i];p.x+=p.vx;p.y+=p.vy;p.vy+=.08;p.l--;if(p.l<=0){pts.splice(i,1);continue}bx.globalAlpha=(p.l/p.ml)*.7;bx.fillStyle=p.c;bx.beginPath();bx.arc(p.x,p.y,p.s*(p.l/p.ml),0,Math.PI*2);bx.fill()}bx.globalAlpha=1;requestAnimationFrame(anim)})();
})();

// CONFIG
var COINS=[
  {id:'bitcoin',sym:'BTC',clr:'#f7931a',fb:96800,vol:.7,df:'Easy'},
  {id:'ethereum',sym:'ETH',clr:'#627eea',fb:2720,vol:.75,df:'Easy'},
  {id:'solana',sym:'SOL',clr:'#00ffa3',fb:172,vol:.9,df:'Med'},
  {id:'dogecoin',sym:'DOGE',clr:'#c3a634',fb:.26,vol:1.2,df:'Hard'},
  {id:'ripple',sym:'XRP',clr:'#00aae4',fb:2.58,vol:.85,df:'Med'},
  {id:'cardano',sym:'ADA',clr:'#3cc8c8',fb:.78,vol:.95,df:'Med'},
  {id:'avalanche-2',sym:'AVAX',clr:'#e84142',fb:26.5,vol:1.1,df:'Hard'},
  {id:'chainlink',sym:'LINK',clr:'#2a5ada',fb:18.4,vol:.9,df:'Med'},
  {id:'sui',sym:'SUI',clr:'#4da2ff',fb:3.65,vol:1.0,df:'Med'},
  {id:'hyperliquid',sym:'HYPE',clr:'#5ce1e6',fb:24.8,vol:1.05,df:'Med'}
];
var TIPS=[
  {t:"Multipliers",c:"5x on 20% gain = 100% profit. Max loss = your stake."},
  {t:"Non-Custodial",c:"Liquid never holds your keys. You stay in control."},
  {t:"TWAP Orders",c:"Splits orders randomly to prevent front-running."},
  {t:"HLP Vault",c:"Earn up to 27% APY on idle USDC via market-making."},
  {t:"Zero-Fee Spot",c:"BTC, ETH, SOL spot = zero fees on Liquid."},
  {t:"Aggregator",c:"Routes across Hyperliquid, Ostium & Lighter."},
  {t:"Swipe Trading",c:"Swipe right=bullish, left=bearish. One tap = trade."},
  {t:"Pre-IPO",c:"Trade OpenAI & others before they go public."},
  {t:"Beyond Crypto",c:"Gold, EURUSD, Nasdaq ‚Äî all with multipliers."},
  {t:"Coinbase Onramp",c:"Buy crypto with card, straight into trading."},
  {t:"Multi-DEX",c:"3 orderbooks competing for best execution."},
  {t:"Prediction Markets",c:"Bet on real events ‚Äî sports, politics, esports."},
  {t:"Revenue Share",c:"Refer friends: 10% off for them, 50% fees for you."},
  {t:"Conviction",c:"\"If you believe it, profit from being right.\""},
  {t:"Mobile-First",c:"Full trading power designed for your phone."},
  {t:"Risk First",c:"Define risk upfront. No surprise margin calls."},
];
var DIFF=[
  {n:'CHILL', c:'#34d399',bg:'rgba(52,211,153,.06)', sm:1,  gm:1,  im:1,  dur:2700},
  {n:'MEDIUM',c:'#fbbf24',bg:'rgba(251,191,36,.06)',  sm:1.2,gm:.88,im:.82,dur:2400},
  {n:'HARD',  c:'#f97316',bg:'rgba(249,115,22,.06)',  sm:1.5,gm:.78,im:.65,dur:2400},
  {n:'INSANE',c:'#ef4444',bg:'rgba(239,68,68,.06)',   sm:1.8,gm:.68,im:.52,dur:1e9}
];

// PRICES
var prices={},sel=null,pOk=false;
function fP(v){return v>=1000?'$'+Math.round(v).toLocaleString():v>=1?'$'+v.toFixed(2):'$'+v.toFixed(4)}
function fetchP(){return fetch('https://api.coingecko.com/api/v3/simple/price?ids='+COINS.map(function(c){return c.id}).join(',')+'&vs_currencies=usd&include_24hr_change=true').then(function(r){if(!r.ok)throw 0;return r.json()}).then(function(d){var n=0;COINS.forEach(function(c){if(d[c.id]){prices[c.id]={p:d[c.id].usd,ch:d[c.id].usd_24h_change||0};n++}});if(n>=5)pOk=true;else throw 0}).catch(function(){COINS.forEach(function(c){if(!prices[c.id])prices[c.id]={p:c.fb,ch:+(Math.random()*6-3).toFixed(1)}})})}
function buildG(){var a=document.getElementById('cA'),g=document.createElement('div');g.className='coins';COINS.forEach(function(c){var d=prices[c.id]||{p:c.fb,ch:0};var el=document.createElement('div');el.className='cc';var dc=c.df==='Easy'?'#34d399':c.df==='Med'?'#fbbf24':'#f97316';var db=c.df==='Easy'?'rgba(52,211,153,.06)':c.df==='Med'?'rgba(251,191,36,.06)':'rgba(249,115,22,.06)';el.innerHTML='<div class="sy" style="color:'+c.clr+'">'+c.sym+'</div><div class="pr">'+fP(d.p)+'</div><div class="ch '+(d.ch>=0?'up':'dn')+'">'+(d.ch>=0?'+':'')+d.ch.toFixed(1)+'%</div><div class="df" style="background:'+db+';color:'+dc+'">'+c.df+'</div>';el.onclick=function(ev){ev.stopPropagation();document.querySelectorAll('.cc').forEach(function(x){x.classList.remove('sel')});el.classList.add('sel');sel=c;var b=document.getElementById('bSt');b.disabled=false;b.textContent='START ‚Üí'};g.appendChild(el)});a.innerHTML='';if(!pOk){var n=document.createElement('div');n.style.cssText="font-family:'JetBrains Mono',monospace;font-size:8px;color:rgba(251,191,36,.2);text-align:center;margin-bottom:6px";n.textContent='‚ö† Estimated ‚Äî CoinGecko may be rate-limited';a.appendChild(n)}a.appendChild(g)}

// LEADERBOARD
var API=window.location.origin,lbD=[];
function fLB(cb){fetch(API+'/api/leaderboard').then(function(r){return r.json()}).then(function(d){lbD=d.scores||[];if(cb)cb()}).catch(function(){lbD=JSON.parse(localStorage.getItem('lr_lb')||'[]');if(cb)cb()})}
function sLB(nm,sc,cn,tm,cb){fetch(API+'/api/score',{method:'POST',headers:{'Content-Type':'application/json'},body:JSON.stringify({name:nm,score:sc,coin:cn,time:tm})}).then(function(r){return r.json()}).then(function(d){lbD=d.scores||[];if(cb)cb(d.rank||0)}).catch(function(){var a=JSON.parse(localStorage.getItem('lr_lb')||'[]');var f=a.find(function(s){return s.name.toLowerCase()===nm.toLowerCase()});if(f){if(sc>f.score){f.score=sc;f.coin=cn;f.time=tm}}else a.push({name:nm,score:sc,coin:cn,time:tm});a.sort(function(a,b){return b.score-a.score});a=a.slice(0,50);localStorage.setItem('lr_lb',JSON.stringify(a));lbD=a;if(cb)cb(a.findIndex(function(s){return s.name.toLowerCase()===nm.toLowerCase()})+1)})}
function rLB(t,hl){var el=document.getElementById(t);if(!lbD.length){el.innerHTML='<div style="font-family:\'JetBrains Mono\',monospace;font-size:9px;color:rgba(92,225,230,.08);text-align:center;padding:8px">No scores yet</div>';return}var h='<h4>üèÜ GLOBAL LEADERBOARD</h4>',m=Math.min(lbD.length,12);for(var i=0;i<m;i++){var s=lbD[i],me=hl&&s.name.toLowerCase()===hl.toLowerCase();var md=i===0?'ü•á':i===1?'ü•à':i===2?'ü•â':'#'+(i+1);var coin=s.coin||'?',tm=s.time||0;h+='<div class="lr'+(me?' me':'')+'"><span class="rk">'+md+'</span><span class="nm">'+s.name+'</span><span class="sv">$'+(s.score||0).toLocaleString()+' ¬∑ '+coin+' ¬∑ '+tm+'s</span></div>'}el.innerHTML=h}

// AUDIO
var ax=null,mu=false,mg=null,mO=false;
function iA(){if(ax)return;try{ax=new(window.AudioContext||window.webkitAudioContext)();mg=ax.createGain();mg.gain.value=.07;mg.connect(ax.destination)}catch(e){}}
function sM(){if(!ax||mO)return;mO=true;[65.41,82.41,98,130.81].forEach(function(f,i){var o=ax.createOscillator(),g=ax.createGain(),fl=ax.createBiquadFilter();o.type='sine';o.frequency.value=f;fl.type='lowpass';fl.frequency.value=150;g.gain.value=.018;o.connect(fl);fl.connect(g);g.connect(mg);o.start(ax.currentTime+i*.3)})}
function bp(f,d){if(!ax||mu)return;var o=ax.createOscillator(),g=ax.createGain();o.type='sine';o.frequency.value=f||800;g.gain.value=.05;g.gain.linearRampToValueAtTime(0,ax.currentTime+(d||.1));o.connect(g);g.connect(ax.destination);o.start();o.stop(ax.currentTime+(d||.1))}
function tgM(e){e.stopPropagation();mu=!mu;if(mg)mg.gain.value=mu?0:.07;document.getElementById('mb').textContent=mu?'üîá':'üîä'}

// PRICE ENGINE
function PE(b){this.p=b;this.b=b;this.v=b>500?.0004:b>5?.0008:.0015;this.tr=0;this.tt=0;this.h=[];for(var i=0;i<300;i++)this.tick()}
PE.prototype.tick=function(){if(--this.tt<=0){this.tr=(Math.random()-.5)*this.v*2.5;this.tt=30+Math.random()*80}this.p*=1+this.tr+(Math.random()-.5)*this.v;this.p=Math.max(this.b*.85,Math.min(this.b*1.15,this.p));this.h.push(this.p);if(this.h.length>500)this.h.shift()};

// PARTICLE
function Pt(x,y,c,vx,vy,l){this.x=x;this.y=y;this.c=c;this.vx=vx;this.vy=vy;this.l=l;this.ml=l;this.s=1+Math.random()*2.5}
Pt.prototype.u=function(){this.x+=this.vx;this.y+=this.vy;this.vy+=.02;this.l--};
Pt.prototype.d=function(cx){var a=this.l/this.ml;cx.globalAlpha=a*.6;cx.fillStyle=this.c;cx.beginPath();cx.arc(this.x,this.y,this.s*a,0,Math.PI*2);cx.fill();cx.globalAlpha=1};

// LIQUID DROP SHAPE ‚Äî pointy top, round bottom
function dDrop(cx,x,y,sz,col,al){
  cx.save();cx.translate(x,y);cx.globalAlpha=al;cx.beginPath();
  cx.moveTo(0,-sz*1.15);
  cx.bezierCurveTo(-sz*.12,-sz*.75, -sz*.85,-sz*.15, -sz*.7,sz*.4);
  cx.bezierCurveTo(-sz*.55,sz*.9, -sz*.2,sz*1.1, 0,sz*1.1);
  cx.bezierCurveTo(sz*.2,sz*1.1, sz*.55,sz*.9, sz*.7,sz*.4);
  cx.bezierCurveTo(sz*.85,-sz*.15, sz*.12,-sz*.75, 0,-sz*1.15);
  cx.closePath();
  var g=cx.createRadialGradient(-sz*.12,-sz*.05,sz*.06,0,sz*.25,sz*1.1);
  g.addColorStop(0,'rgba(255,255,255,.3)');g.addColorStop(.4,col);g.addColorStop(1,'rgba(92,225,230,.08)');
  cx.fillStyle=g;cx.fill();cx.strokeStyle='rgba(255,255,255,.1)';cx.lineWidth=.6;cx.stroke();
  cx.beginPath();cx.ellipse(-sz*.15,-sz*.3,sz*.13,sz*.07,-0.3,0,Math.PI*2);
  cx.fillStyle='rgba(255,255,255,.22)';cx.fill();
  cx.restore();cx.globalAlpha=1;
}

// ======== GAME ========
var G;
function Game(){
  G=this;this.cv=document.getElementById('c');this.cx=this.cv.getContext('2d');
  this.fit();window.addEventListener('resize',function(){G.fit()});
  this.st=0;this.sc=0;this.dn=0;this.suC=0;this.sug=false;this.suT=0;this.SD=360;this.sM=1;
  this.fr=0;this.sp=0;this.sx=0;this.ts=0;this.di=0;this.bP=0;
  this.py={x:0,y:0,vy:0};this.PS=16;
  this.GR=.17;this.FL=-5.5;this.BS=1.3;this.BG=255;this.BI=195;
  this.tl=[];this.cn=[];this.dr=[];this.pt=[];this.gY=0;this.lcx=0;
  this.tI=0;this._tt=0;
  this.stars=[];for(var i=0;i<50;i++)this.stars.push({x:Math.random()*3000,y:Math.random()*2000,s:Math.random()+.4,sp:Math.random()*.05+.012,ph:Math.random()*6.28});
  this.pe=null;this.ecg=0;
  this.inp();this.loop();
}
Game.prototype.fit=function(){var d=Math.min(devicePixelRatio||1,2);this.W=innerWidth;this.H=innerHeight;this.cv.width=this.W*d;this.cv.height=this.H*d;this.cv.style.width=this.W+'px';this.cv.style.height=this.H+'px';this.cx.setTransform(d,0,0,d,0,0)};
Game.prototype.inp=function(){
  var s=this;
  this.cv.addEventListener('pointerdown',function(e){e.preventDefault();if(s.st===2){iA();sM();s.flap()}});
  document.addEventListener('keydown',function(e){if(!e.repeat&&(e.code==='Space'||e.code==='ArrowUp')){e.preventDefault();if(s.st===2){iA();sM();s.flap()}}});
  document.getElementById('bGo').onclick=function(e){e.stopPropagation();s.show('sC')};
  document.getElementById('bBI').onclick=function(e){e.stopPropagation();s.show('sI')};
  document.getElementById('bSt').onclick=function(e){e.stopPropagation();iA();s.begin()};
  document.getElementById('bBC').onclick=function(e){e.stopPropagation();s.st=0;s.show('sC')};
  document.getElementById('bLB').onclick=function(e){e.stopPropagation();var p=document.getElementById('lbPI');p.classList.toggle('show');if(p.classList.contains('show'))fLB(function(){rLB('lbI',localStorage.getItem('lr_nm'))})};
  // Icon click ‚Üí pop + small Gliquid
  ['lgT','lgB'].forEach(function(id){var el=document.getElementById(id);if(!el)return;el.addEventListener('click',function(e){
    e.stopPropagation();
    el.classList.add('pop');
    // Particles
    var r=el.getBoundingClientRect(),cx=r.left+r.width/2,cy=r.top+r.height/2;
    var cv=document.createElement('canvas');cv.style.cssText='position:fixed;inset:0;pointer-events:none;z-index:250';cv.width=innerWidth;cv.height=innerHeight;document.body.appendChild(cv);
    var ctx=cv.getContext('2d'),pp=[];
    for(var i=0;i<20;i++){var a=Math.random()*Math.PI*2,sp=2+Math.random()*5;pp.push({x:cx,y:cy,vx:Math.cos(a)*sp,vy:Math.sin(a)*sp-1,l:25+Math.random()*15,ml:40,s:2+Math.random()*3,c:['#5ce1e6','#38b6ff','#fbbf24'][i%3]})}
    function anim(){ctx.clearRect(0,0,cv.width,cv.height);var alive=false;for(var i=0;i<pp.length;i++){var p=pp[i];p.x+=p.vx;p.y+=p.vy;p.vy+=.08;p.l--;if(p.l<=0)continue;alive=true;ctx.globalAlpha=(p.l/p.ml)*.7;ctx.fillStyle=p.c;ctx.beginPath();ctx.arc(p.x,p.y,p.s*(p.l/p.ml),0,Math.PI*2);ctx.fill()}ctx.globalAlpha=1;if(alive)requestAnimationFrame(anim);else cv.remove()}anim();
    // Show small Gliquid
    var gp=document.getElementById('gliqP');gp.classList.add('show');
    setTimeout(function(){gp.classList.remove('show')},1400);
    setTimeout(function(){el.classList.remove('pop')},2500);
  })});
};
Game.prototype.show=function(id){
  ['sBubble','sI','sC','sD'].forEach(function(x){document.getElementById(x).classList.toggle('off',x!==id)});
  // Trigger logo animations when intro is shown
  if(id==='sI'){setTimeout(function(){var t=document.getElementById('lgT'),b=document.getElementById('lgB');if(t)t.classList.add('anim');if(b)b.classList.add('anim')},100)}
};
Game.prototype.hideAll=function(){['sBubble','sI','sC','sD'].forEach(function(x){document.getElementById(x).classList.add('off')})};
Game.prototype.flap=function(){this.py.vy=this.FL;bp(450+Math.random()*250,.04);var cl=sel?sel.clr:'#5ce1e6';for(var i=0;i<4;i++)this.pt.push(new Pt(this.py.x-6,this.py.y+Math.random()*8-4,cl,-Math.random()*1.2-.2,(Math.random()-.5)*1.8,12+Math.random()*6))};
Game.prototype.begin=function(){
  if(!sel)return;this.st=1;this.cdS=performance.now();
  this.sc=0;this.dn=0;this.suC=0;this.sug=false;this.suT=0;this.sM=1;
  this.fr=0;this.sx=0;this.ts=0;this.di=0;this.bP=0;
  this.cn=[];this.dr=[];this.pt=[];this.tl=[];
  this.gY=this.H/2;this.lcx=-999;this.tI=0;
  this.py={x:this.W*.15,y:this.H*.5,vy:0};
  var pd=prices[sel.id];this.pe=new PE(pd?pd.p:sel.fb);
  this.hideAll();document.getElementById('hud').style.display='flex';document.getElementById('tip').classList.remove('on');
  document.getElementById('hP').textContent=sel.sym+' '+fP(this.pe.p);this.uDH();sM();
};
Game.prototype.gSp=function(){return this.BS*DIFF[this.di].sm*(sel?sel.vol:1)};
Game.prototype.gGp=function(){return this.BG*DIFF[this.di].gm/Math.sqrt(sel?sel.vol:1)};
Game.prototype.gIn=function(){return Math.round(this.BI*DIFF[this.di].im)};
Game.prototype.uDH=function(){var d=DIFF[this.di];var e=document.getElementById('hD');e.textContent=d.n;e.style.background=d.bg;e.style.color=d.c};
Game.prototype.die=function(msg){
  if(this.st!==2)return;this.st=3;bp(200,.3);setTimeout(function(){bp(100,.35)},120);
  for(var i=0;i<14;i++)this.pt.push(new Pt(this.py.x,this.py.y,i%2?'#f87171':'#5ce1e6',(Math.random()-.5)*6,(Math.random()-.5)*6,22+Math.random()*10));
  document.getElementById('sbar').classList.remove('on');var s=this;
  setTimeout(function(){document.getElementById('hud').style.display='none';document.getElementById('cdEl').classList.remove('on');document.getElementById('dS').textContent='$'+s.sc.toLocaleString();document.getElementById('dTm').textContent=s.ts+'s';document.getElementById('dT').textContent=s.dn;document.getElementById('dR').textContent=msg;document.getElementById('nI').value=localStorage.getItem('lr_nm')||'';var btn=document.getElementById('bSv');btn.textContent='SAVE & PLAY AGAIN';btn.disabled=false;btn.onclick=function(e){e.stopPropagation();var nm=(document.getElementById('nI').value||'').trim()||'Anon';localStorage.setItem('lr_nm',nm);btn.textContent='SAVING...';btn.disabled=true;sLB(nm,s.sc,sel?sel.sym:'?',s.ts,function(rk){btn.textContent='#'+rk+' ‚Äî PLAY AGAIN';btn.disabled=false;rLB('lbA',nm);btn.onclick=function(e2){e2.stopPropagation();s.begin()}})};fLB(function(){rLB('lbA',localStorage.getItem('lr_nm'))});s.show('sD')},450);
};
Game.prototype.spC=function(){
  var gap=this.gGp(),pad=55,minY=pad+gap/2,maxY=this.H-pad-gap/2;
  var tgt=this.gY+(Math.random()-.5)*gap*.45*2;tgt=Math.max(minY,Math.min(maxY,tgt));this.gY=tgt;
  var x=this.W+60;if(x-this.lcx<55)x=this.lcx+55;this.lcx=x;
  var bw=18+Math.random()*20,red=Math.random()>.4,col=red?'#f87171':'#34d399';
  var gT=tgt-gap/2,gB=tgt+gap/2;
  var tWT=Math.max(3,Math.random()*15),tBT=tWT+8+Math.random()*Math.max(8,gT-tWT-35),tBB=gT-4-Math.random()*12;if(tBB<tBT+6)tBB=tBT+6;
  var bWT=gB,bBT=gB+4+Math.random()*12,bBB=bBT+18+Math.random()*Math.max(8,this.H-bBT-25);if(bBB>this.H-4)bBB=this.H-4;var bWB=Math.min(this.H-2,bBB+8+Math.random()*18);
  if(gT>20)this.cn.push({x:x,w:bw,bt:tBT,bb:tBB,wt:tWT,wb:gT,col:col,ps:false,osc:Math.random()*6.28,oscA:8+Math.random()*10,oscS:.015+Math.random()*8e-3,oy:0});
  if(gB<this.H-20)this.cn.push({x:x,w:bw,bt:bBT,bb:bBB,wt:bWT,wb:bWB,col:col,ps:false,osc:Math.random()*6.28,oscA:8+Math.random()*10,oscS:.015+Math.random()*8e-3,oy:0});
};
Game.prototype.spD=function(){
  var y=this.gY+(Math.random()-.5)*50;y=Math.max(40,Math.min(this.H-40,y));
  var xP=this.W+30+Math.random()*30,safe=true;
  for(var i=0;i<this.cn.length;i++){var c=this.cn[i];if(Math.abs(xP-c.x)<c.w+20&&y>c.wt&&y<c.wb){safe=false;break}}
  if(!safe)y=this.gY;
  this.dr.push({x:xP,y:y,sz:12,gl:0});
};
Game.prototype.sTip=function(){var t=TIPS[this.tI%TIPS.length];this.tI++;document.getElementById('tT').textContent='üíß '+t.t;document.getElementById('tC').textContent=t.c;document.getElementById('tip').classList.add('on');clearTimeout(this._tt);this._tt=setTimeout(function(){document.getElementById('tip').classList.remove('on')},4200)};
Game.prototype.surge=function(){this.sug=true;this.suT=this.SD;this.suC=0;bp(600,.12);setTimeout(function(){bp(900,.1)},60);setTimeout(function(){bp(1200,.12)},120);document.getElementById('sbar').classList.add('on');for(var i=0;i<16;i++)this.pt.push(new Pt(this.py.x,this.py.y,'#fbbf24',(Math.random()-.5)*7,(Math.random()-.5)*7,24+Math.random()*10))};

Game.prototype.upd=function(){
  if(this.st===1){var el=(performance.now()-this.cdS)/1000;var v=3-Math.floor(el);var cd=document.getElementById('cdEl');if(v>0){cd.textContent=v;cd.classList.add('on')}else{cd.textContent='GO!';cd.classList.add('on');this.st=2;var s=this;setTimeout(function(){cd.classList.remove('on')},280)}this.py.y=this.H*.5+Math.sin(performance.now()*.003)*8;this.pe.tick();return}
  if(this.st!==2)return;this.fr++;
  if(this.fr%60===0)this.ts++;document.getElementById('hTm').textContent=this.ts+'s';
  var tot=0;for(var i=0;i<DIFF.length;i++){tot+=DIFF[i].dur;if(this.fr<tot){if(this.di!==i){this.di=i;this.uDH()}break}}
  this.sp=this.gSp();
  if(this.fr%5===0){this.pe.tick();document.getElementById('hP').textContent=sel.sym+' '+fP(this.pe.p)}
  this.sc=Math.floor(this.fr*this.sp*.25*this.sM);
  document.getElementById('hS').textContent='$'+this.sc.toLocaleString();document.getElementById('hT').textContent=this.dn;document.getElementById('hSu').textContent=this.sM.toFixed(1)+'x';
  if(this.sug){this.suT--;document.getElementById('sfill').style.width=Math.max(0,this.suT/this.SD*100)+'%';if(this.suT<=0){this.sug=false;document.getElementById('sbar').classList.remove('on')}}
  if(this.bP>0)this.bP-=.02;
  this.py.vy+=this.GR;if(this.py.vy>5.5)this.py.vy=5.5;if(this.py.vy<-7.5)this.py.vy=-7.5;this.py.y+=this.py.vy;
  this.tl.push({x:this.py.x,y:this.py.y,a:1});if(this.tl.length>12)this.tl.shift();for(var i=0;i<this.tl.length;i++)this.tl[i].a-=.08;
  if(this.py.y<this.PS+2){this.py.y=this.PS+2;this.py.vy=.1}
  if(this.py.y>this.H-this.PS-2){this.die('Hit the floor ‚Äî set a stop loss');return}
  if(this.fr>=80&&(this.fr-80)%this.gIn()===0)this.spC();
  if(this.fr>50&&this.fr%95===40)this.spD();
  for(var i=this.cn.length-1;i>=0;i--){var c=this.cn[i];c.x-=this.sp;c.osc+=c.oscS;c.oy=Math.sin(c.osc)*c.oscA;if(c.x+c.w<-80){this.cn.splice(i,1);continue}if(!c.ps&&c.x+c.w<this.py.x){c.ps=true;this.sc+=3;this.bP=1;bp(440,.04)}if(this.hC(c)){if(this.sug){for(var j=0;j<4;j++)this.pt.push(new Pt(c.x+c.w/2,this.py.y,c.col,(Math.random()-.5)*5,(Math.random()-.5)*5,14));this.cn.splice(i,1);continue}this.die(c.col==='#f87171'?'Red candle ‚Äî bears win':'Green candle caught you');return}}
  for(var i=this.dr.length-1;i>=0;i--){var d=this.dr[i];d.x-=this.sp;d.gl=(d.gl+.04)%(Math.PI*2);if(d.x<-40){this.dr.splice(i,1);continue}var dx=this.py.x-d.x,dy=this.py.y-d.y;if(Math.sqrt(dx*dx+dy*dy)<this.PS+d.sz+6){this.dn++;this.suC++;this.sM+=.15;bp(1200,.07);setTimeout(function(){bp(1600,.05)},40);for(var j=0;j<4;j++)this.pt.push(new Pt(d.x,d.y,'#5ce1e6',(Math.random()-.5)*3,(Math.random()-.5)*3,12));this.dr.splice(i,1);if(this.dn%10===0)this.sTip();if(this.suC>=5&&!this.sug)this.surge()}}
  for(var i=this.pt.length-1;i>=0;i--){this.pt[i].u();if(this.pt[i].l<=0)this.pt.splice(i,1)}
  this.sx+=this.sp;
};
Game.prototype.hC=function(c){var px=this.py.x,py=this.py.y,r=this.PS*.44,oy=c.oy||0;var cx=Math.max(c.x,Math.min(px,c.x+c.w)),cy=Math.max(c.bt+oy,Math.min(py,c.bb+oy));var dx=px-cx,dy=py-cy;if(dx*dx+dy*dy<r*r)return true;var wx=c.x+c.w/2,ww=1.5;if(px+r>wx-ww&&px-r<wx+ww&&py+r>c.wt+oy&&py-r<c.bt+oy)return true;if(px+r>wx-ww&&px-r<wx+ww&&py+r>c.bb+oy&&py-r<c.wb+oy)return true;return false};
Game.prototype.drw=function(){
  var cx=this.cx;cx.clearRect(0,0,this.W,this.H);
  // BG ‚Äî more visible gradient
  var bg=cx.createLinearGradient(0,0,0,this.H);
  bg.addColorStop(0,'#0d1228');bg.addColorStop(.3,'#111d3a');bg.addColorStop(.6,'#142244');bg.addColorStop(1,'#0d1228');
  cx.fillStyle=bg;cx.fillRect(0,0,this.W,this.H);
  // Radial glow
  var rg=cx.createRadialGradient(this.W/2,this.H/2,0,this.W/2,this.H/2,this.W*.6);
  rg.addColorStop(0,'rgba(92,225,230,.025)');rg.addColorStop(1,'transparent');
  cx.fillStyle=rg;cx.fillRect(0,0,this.W,this.H);
  if(this.bP>0){cx.globalAlpha=this.bP*.05;cx.fillStyle=sel?sel.clr:'#5ce1e6';cx.fillRect(0,0,this.W,this.H);cx.globalAlpha=1}
  if(this.sug){cx.globalAlpha=.03+Math.sin(this.fr*.09)*.015;cx.fillStyle='#fbbf24';cx.fillRect(0,0,this.W,this.H);cx.globalAlpha=1}
  // Stars
  var mv=this.st===2||this.st===1;
  for(var i=0;i<this.stars.length;i++){var s=this.stars[i];s.x-=s.sp*(mv?this.sp*.05:.03);if(s.x<0){s.x=this.W+Math.random()*100;s.y=Math.random()*this.H}s.ph+=.005;cx.globalAlpha=.1+Math.sin(s.ph)*.06;cx.fillStyle='#5ce1e6';cx.beginPath();cx.arc(s.x,s.y,s.s,0,Math.PI*2);cx.fill()}cx.globalAlpha=1;
  // Chart line ‚Äî MORE VISIBLE
  if(this.pe){var h=this.pe.h;if(h.length>2){var mn=h[0],mx=h[0];for(var i=1;i<h.length;i++){if(h[i]<mn)mn=h[i];if(h[i]>mx)mx=h[i]}var rg2=mx-mn||1;var cl=sel?sel.clr:'#5ce1e6';cx.beginPath();for(var i=0;i<h.length;i++){var x=i/h.length*this.W,y=this.H-((h[i]-mn)/rg2)*this.H*.4-this.H*.22;i?cx.lineTo(x,y):cx.moveTo(x,y)}cx.globalAlpha=.12;cx.strokeStyle=cl;cx.lineWidth=2;cx.stroke();cx.lineTo(this.W,this.H);cx.lineTo(0,this.H);cx.closePath();cx.globalAlpha=.025;cx.fillStyle=cl;cx.fill();cx.globalAlpha=1}}
  // Grid
  cx.strokeStyle='rgba(92,225,230,.02)';cx.lineWidth=1;
  for(var y=0;y<this.H;y+=60){cx.beginPath();cx.moveTo(0,y);cx.lineTo(this.W,y);cx.stroke()}
  for(var x=(-this.sx%60);x<this.W;x+=60){cx.beginPath();cx.moveTo(x,0);cx.lineTo(x,this.H);cx.stroke()}
  for(var i=0;i<this.cn.length;i++)this.dC(cx,this.cn[i]);
  for(var i=0;i<this.dr.length;i++)this.dDr(cx,this.dr[i]);
  for(var i=0;i<this.pt.length;i++)this.pt[i].d(cx);
  if(this.st===2||this.st===1)this.dP(cx);
  this.dE(cx);
};
Game.prototype.dC=function(cx,cn){
  var x=cn.x,w=cn.w,col=cn.col,wx=x+w/2,oy=cn.oy||0;
  cx.globalAlpha=.25;cx.strokeStyle=col;cx.lineWidth=2.5;cx.beginPath();cx.moveTo(wx,cn.wt+oy);cx.lineTo(wx,cn.wb+oy);cx.stroke();
  var bt=cn.bt+oy,bb=cn.bb+oy,bh=bb-bt;
  if(bh>3){cx.globalAlpha=.45;cx.fillStyle=col;var r=Math.min(4,bh/2,w/2);cx.beginPath();cx.moveTo(x+r,bt);cx.lineTo(x+w-r,bt);cx.quadraticCurveTo(x+w,bt,x+w,bt+r);cx.lineTo(x+w,bb-r);cx.quadraticCurveTo(x+w,bb,x+w-r,bb);cx.lineTo(x+r,bb);cx.quadraticCurveTo(x,bb,x,bb-r);cx.lineTo(x,bt+r);cx.quadraticCurveTo(x,bt,x+r,bt);cx.closePath();cx.fill();cx.globalAlpha=.12;cx.strokeStyle=col;cx.lineWidth=1;cx.stroke()}
  cx.shadowColor=col;cx.shadowBlur=6;cx.globalAlpha=0;cx.beginPath();cx.arc(wx,(bt+bb)/2,.1,0,Math.PI*2);cx.fill();cx.shadowBlur=0;cx.globalAlpha=1;
};
Game.prototype.dDr=function(cx,d){var gl=.5+Math.sin(d.gl)*.3;cx.save();cx.translate(d.x,d.y);cx.shadowColor='#5ce1e6';cx.shadowBlur=12+gl*12;dDrop(cx,0,0,d.sz,'rgba(92,225,230,'+(0.5+gl*.4)+')',.7+gl*.3);cx.shadowBlur=0;cx.restore();cx.globalAlpha=1};
Game.prototype.dP=function(cx){
  var px=this.py.x,py=this.py.y,sz=this.PS,cl=sel?sel.clr:'#5ce1e6';
  for(var i=0;i<this.tl.length;i++){var t=this.tl[i];if(t.a<=0)continue;cx.globalAlpha=t.a*.1;cx.fillStyle=this.sug?'#fbbf24':cl;cx.beginPath();cx.arc(t.x,t.y,sz*.18*t.a,0,Math.PI*2);cx.fill()}cx.globalAlpha=1;
  cx.save();cx.translate(px,py);var tilt=Math.max(-.25,Math.min(.25,this.py.vy*.03));cx.rotate(tilt);
  if(this.sug){cx.shadowColor='#fbbf24';cx.shadowBlur=28;cx.strokeStyle='rgba(251,191,36,'+(0.22+Math.sin(this.fr*.1)*.1)+')';cx.lineWidth=2;cx.beginPath();cx.arc(0,0,sz+7,0,Math.PI*2);cx.stroke();cx.shadowBlur=0}
  cx.shadowColor=this.sug?'#fbbf24':cl;cx.shadowBlur=22;
  dDrop(cx,0,0,sz*1.1,this.sug?'#fbbf24':cl,this.sug?.9:1);
  cx.shadowBlur=0;cx.restore();
};
// ECG ‚Äî MORE VISIBLE
Game.prototype.dE=function(cx){
  if(this.st!==2&&this.st!==1)return;this.ecg+=.025;var cl=sel?sel.clr:'#5ce1e6';
  var int=.12+this.bP*.3;
  cx.beginPath();for(var x=0;x<this.W;x+=3){var t=(x/this.W)*Math.PI*4+this.ecg;var v=((t%(Math.PI*2))-1);var b=Math.exp(-(v*v)*8)*(6+this.bP*18);var y=this.H-5-b;x===0?cx.moveTo(x,y):cx.lineTo(x,y)}
  cx.globalAlpha=int;cx.strokeStyle=cl;cx.lineWidth=1.5+this.bP*2;cx.stroke();cx.globalAlpha=1;
};
Game.prototype.loop=function(){
  if(this.st===0){var cx=this.cx;cx.clearRect(0,0,this.W,this.H);var bg=cx.createLinearGradient(0,0,0,this.H);bg.addColorStop(0,'#0d1228');bg.addColorStop(.5,'#111d3a');bg.addColorStop(1,'#0d1228');cx.fillStyle=bg;cx.fillRect(0,0,this.W,this.H);for(var i=0;i<this.stars.length;i++){var s=this.stars[i];s.x-=s.sp*.03;if(s.x<0)s.x=this.W+50;s.ph+=.005;cx.globalAlpha=.1+Math.sin(s.ph)*.06;cx.fillStyle='#5ce1e6';cx.beginPath();cx.arc(s.x,s.y,s.s,0,Math.PI*2);cx.fill()}cx.globalAlpha=1}
  else{this.upd();this.drw()}
  requestAnimationFrame(function(){G.loop()});
};
window.addEventListener('DOMContentLoaded',function(){new Game();fetchP().then(function(){buildG()});setInterval(function(){fetchP().then(function(){if(!document.getElementById('sC').classList.contains('off')){var p=sel;buildG();if(p){var cc=document.querySelectorAll('.cc');for(var i=0;i<cc.length;i++)if(COINS[i].id===p.id)cc[i].classList.add('sel')}}})},30000)});
</script>
</body>
</html>
